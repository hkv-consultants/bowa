{% extends "bowa/result.html" %}

{% block javascript %}
  {{ block.super }}
<script>

  var toetseenheid = $('#toetseenheid>option:selected').text();
  var grondgebruik = $('#grondgebruik>option:selected').text();
  var normfunctie =  $('#normfunctie>option:selected').val();

  set_image_url(toetseenheid, grondgebruik, normfunctie);

  $("#toetseenheid").change(function() {
    toetseenheid = $(this).val();
    set_image_url(toetseenheid, grondgebruik, normfunctie);
  });

  $("#grondgebruik").change(function() {
    grondgebruik = $(this).val();
    set_image_url(toetseenheid, grondgebruik, normfunctie);
  });

  $("#normfunctie").change(function() {
    normfunctie = $(this).val();
    set_image_url(toetseenheid, grondgebruik, normfunctie);
  });

  function set_image_url(toetseenheid, grondgebruik, normfunctie) {
    var base_image_url = "{% url bowa_result_graph_image slug=view.result.slug %}";

    var image_url = base_image_url + "?toetseenheid=" + toetseenheid + "&grondgebruik=" + grondgebruik + "&normfunctie=" + normfunctie;

    var imagediv = document.getElementById("imageDiv");
    imagediv.src = image_url;

  }


</script>
{% endblock javascript %}

{% block content %}
<div class="container">
    <h1>Resultaten - Grafiek</h1>
    <div class="row well">
		<div class="span3">
			<div class="control-group">
				<label class="control-label" for="toetseenheid">Toetseenheid</label>
				<select id="toetseenheid">
					{% for row in view.result.list_of_toetseenheden %}
						<option>{{ row }}</option>
					{% endfor %}
				</select>
			</div>
			<div class="control-group">
				<label class="control-label" for="grondgebruik">Grondgebruik</label>
				<select id="grondgebruik">
					{% for row in view.result.list_of_grondgebruiken %}
						<option>{{ row }}</option>
					{% endfor %}
				</select>
			</div>
			<div class="control-group">
				<label class="control-label" for="normfunctie">Normfunctie</label>
				<select id="normfunctie">
					 <option value="toetshoogte">Toetshoogte [m+NAP]</option>
					 <option value="volume">Volume [m**3]</option>
					 <option value="oppervlakte">Oppervlakte [m**2]</option>
					 <option value="percentage">Percentage [%]</option>
				</select>
			</div>
			<div class="control-group">
                           	<button class="btn btn-primary" type="button">Download</button>
			</div>
		</div>
		<div class="span1">
		</div>
		<div class="span7">
		  <img id="imageDiv" />
		</div>
    </div>
</div>
{% endblock content %}
